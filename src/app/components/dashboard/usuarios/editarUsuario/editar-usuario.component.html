<div class="module-card fade-in">
  <h3>Editar Usuario</h3>

  <!-- Loading spinner -->
  <div *ngIf="cargando" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <form *ngIf="!cargando" (ngSubmit)="guardarUsuario()" class="mt-4">
    <div class="row gy-3">
      <div class="col-md-6">
        <label for="nombre" class="form-label fw-bold">Nombre Completo</label>
        <input type="text" id="nombre" [(ngModel)]="usuario.nombre" name="nombre" class="form-control"
          placeholder="Ejemplo: María López" required />
      </div>

      <div class="col-md-6">
        <label for="telefono" class="form-label fw-bold">Teléfono</label>
        <input type="text" id="telefono" [(ngModel)]="usuario.telefono" name="telefono" class="form-control"
          placeholder="Ejemplo: 8888-1234" />
      </div>

      <div class="col-md-6">
        <label for="correo" class="form-label fw-bold">Correo Electrónico</label>
        <input type="email" id="correo" [(ngModel)]="usuario.correo" name="correo" class="form-control"
          placeholder="usuario@email.com" required />
      </div>

      <div class="col-md-6">
        <label for="fecha_registro" class="form-label fw-bold">Fecha de Registro</label>
        <input type="date" id="fecha_registro" [(ngModel)]="usuario.fecha_registro" name="fecha_registro"
          class="form-control" disabled />
      </div>

      <div class="col-md-6">
        <label for="ruta_img" class="form-label fw-bold">Imagen de Perfil</label>
        <input type="file" id="ruta_img" (change)="cargarImagen($event)" accept="image/*" class="form-control" />
      </div>
      
      <div class="mt-2 vista-img-derecha" *ngIf="usuario.ruta_img">
        <img [src]="usuario.ruta_img" alt="Vista previa" 
             (error)="$event.target.src='assets/img/default-avatar.png'" />
      </div>

      <div class="col-12">
        <label for="preferencias" class="form-label fw-bold">Preferencias</label>
        <textarea id="preferencias" [(ngModel)]="usuario.preferencias" name="preferencias" class="form-control" rows="3"
          placeholder="Ejemplo: Prefiere tonos nude y citas por la mañana"></textarea>
      </div>
    </div>

    <div class="text-end mt-4">
      <button type="submit" class="btn btn-save me-2" [disabled]="cargando">
        <i class="bi bi-check-circle"></i> Guardar Cambios
      </button>
      <button type="button" class="btn btn-secondary" (click)="cancelar()">
        <i class="bi bi-x-circle"></i> Cancelar
      </button>
    </div>
  </form>
</div>